<app-navbar>
  <app-page-title title="Browse events"></app-page-title>
  <div fxLayout="row" fxLayout.lt-sm="column" fxLayoutGap="20px" id="eventManager">
    <div class="cards" fxFlex.lt-md="0 0 60%" fxFlex.lt-sm="0 1" [@listStagger]="availableEvents">
      <mat-toolbar class="mat-primary rounded-bar">
        Available Events
        <div class="spacer"></div>
        <mat-icon class="refresh" aria-hidden="false" aria-label="Refresh" (click)="refreshEvents()">refresh</mat-icon>
      </mat-toolbar>
      <mat-card *ngIf="availableEvents.length == 0">
        <mat-card-content>
          <p>
            No events currently available.
          </p>
        </mat-card-content>
      </mat-card>
      <mat-card *ngFor="let event of availableEvents">
        <mat-card-header>
          <mat-card-title>{{ event.displayName }}</mat-card-title>
          <mat-card-subtitle>{{ formatDate(event.startTime) }} - {{ formatDate(event.endTime) }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p><b>About:</b> {{ event.description }}</p>
          <p><b>Signed up ({{ event.signedUp.length }}/{{ event.maxSignups }}):</b> {{ listMembers(event)}}</p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button matTooltip="Sign up for this event" (click)="signUp(event)">SIGN UP</button>
          <button mat-button matTooltip="Contact the facilitators of this event">CONTACT</button>
        </mat-card-actions>
      </mat-card>
    </div>
    <div fxFlex.lt-md="0 0 40%" fxFlex.lt-sm="0 1">
      <mat-toolbar class="mat-primary rounded-bar">
        Your Events
        <div class="spacer"></div>
        <mat-icon class="refresh" aria-hidden="false" aria-label="Refresh" (click)="refreshMyEvents()">refresh</mat-icon>
      </mat-toolbar>
      <mat-tab-group>
        <mat-tab>
          <ng-template matTabLabel>
            <span matBadge="{{ myEvents.future.length }}" matBadgeOverlap="false">Upcoming</span>
          </ng-template>
          <mat-accordion *ngIf="myEvents.future.length == 0">
            <mat-expansion-panel [disabled]="true">
              <mat-expansion-panel-header>
                No upcoming events.
              </mat-expansion-panel-header>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion *ngFor="let future of myEvents.future">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                {{ future.displayName }}
              </mat-expansion-panel-header>
              <p><b>Time:</b> {{ formatDate(future.startTime) }} - {{ formatDate(future.endTime) }}</p>
              <p><b>About:</b> {{ future.description }}</p>
              <p><b>Signed up ({{ future.signedUp.length }}/{{ future.maxSignups }}):</b> {{ listMembers(future)}}</p>
              <mat-action-row>
                <button mat-button (click)="drop(future)">Drop</button>
              </mat-action-row>
            </mat-expansion-panel>
          </mat-accordion>
        </mat-tab>
        <mat-tab>
          <ng-template matTabLabel>
            <span matBadge="{{ myEvents.past.length }}" matBadgeOverlap="false">Past</span>
          </ng-template>
          <mat-accordion *ngIf="myEvents.past.length == 0">
            <mat-expansion-panel [disabled]="true">
              <mat-expansion-panel-header>
                No past events.
              </mat-expansion-panel-header>
            </mat-expansion-panel>
          </mat-accordion>
          <mat-accordion *ngFor="let past of myEvents.past">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                {{ past.displayName }}
              </mat-expansion-panel-header>
              <p><b>Time:</b> {{ formatDate(past.startTime) }} - {{ formatDate(past.endTime) }}</p>
              <p><b>About:</b> {{ past.description }}</p>
              <p><b>Signed up ({{ past.signedUp.length }}/{{ past.maxSignups }}):</b> {{ listMembers(past)}}</p>
            </mat-expansion-panel>
          </mat-accordion>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</app-navbar>
